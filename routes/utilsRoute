import express from "express";
import fetch from "node-fetch";

const router = express.Router();

router.get("/detect-country", async (req, res) => {
  try {

    // DO NOT manually send IP
    const response = await fetch(
      "http://ip-api.com/json/"
    );

    const data = await response.json();

    res.json({
      success: true,
      countryCode: data.countryCode || "IN",
    });

  } catch (error) {
    console.log("IP detect error:", error);

    res.json({
      success: false,
      countryCode: "IN",
    });
  }
});

export default router;
